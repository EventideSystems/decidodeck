

<div class="mx-auto max-w-6xl">
  <%= form_with model: @scorecard, url: impact_card_path(@scorecard), scope: :impact_card, class: 'mx-auto max-w-4xl' do |form| %>
    <%= render 'form_header', record: @scorecard %>
    <%= render 'form_body' do %>
      <%= render 'section' do %>
        <%= render 'section_header', title: 'Overview', subtitle: 'General settings this impact card.' %>
        <%= render 'section_body' do %>
          <div class="sm:col-span-4">
            <%= form.label :name %>
            <div class="mt-2">
              <%= form.text_field(:name, placeholder: 'Card name', autofocus: true, required: true) %>
            </div>
          </div>

          <div class="col-span-full">
            <%= form.label :description %>
            <div class="mt-2">
              <%= form.text_area :description, rows: 3, placeholder: '' %>
            </div>
            <p class="text-sm/6 text-gray-600">A brief description of the impact card (optional).</p>
          </div>
        <% end %>
      <% end %>

      <%= render 'sharing', impact_card: @scorecard %>

      <%= render 'section' do %>
        <%= render 'section_header', title: 'Danger Zone' %>
        <%= render 'section_body', class: 'border border-red-500 rounded-lg gap-y-0' do %>
          <div class="sm:col-span-6 border-b border-gray-900 p-4">
            <%= custom_label_tag 'Delete this impact card card' %>
            <div class="mt-2">
              <p class="text-sm/6 text-gray-600">This action cannot be undone. This will permanently delete the impact card and all associated data.</p>
              <div class="flex justify-end">
                <%=
                  link_to(
                    'Delete Card',
                    impact_card_path(@scorecard),
                    method: :delete,
                    data: { confirm: 'Are you sure you want to delete this impact card?' },
                    class: 'rounded-md bg-zinc-950 dark:bg-zinc-400 px-3 py-2 text-sm font-semibold text-white shadow-sm flex items-center space-x-2 text-red-600 hover:text-red-800'
                  )
                %>
              </div>
            </div>
          </div>

          <div class="sm:col-span-6 border-b border-gray-900 p-4">

            <% if @scorecard.shared_link_id.present? %>
              <%= custom_label_tag 'Disable sharing' %>
              <div class="mt-2">
                <p class="text-sm/6 text-gray-600">Remove third party access.</p>
                <div class="flex justify-end">
                  <%=
                    link_to 'Disable Sharing',
                    impact_card_path(@scorecard),
                    method: :post,
                    data: { confirm: 'Are you sure you want to delete this impact card?' },
                    class: 'rounded-md bg-zinc-950 dark:bg-zinc-400 px-3 py-2 text-sm font-semibold text-white shadow-sm flex items-center space-x-2 text-red-600 hover:text-red-800'
                  %>
                </div>
              </div>
            <% else %>
              <%= custom_label_tag 'Enable sharing' %>
              <div class="mt-2">
                <p class="text-sm/6 text-gray-600">Allow third party access.</p>
                <div class="flex justify-end">
                  <%=
                    link_to 'Enable Sharing',
                    impact_card_path(@scorecard),
                    method: :delete,
                    data: { confirm: 'Are you sure you want to delete this impact card?' },
                    class: 'rounded-md bg-zinc-950 dark:bg-zinc-400 px-3 py-2 text-sm font-semibold text-white shadow-sm flex items-center space-x-2 text-red-600 hover:text-red-800'
                  %>
                </div>
              </div>
            <% end %>
          </div>

          <div class="sm:col-span-6 p-4">
            <%= custom_label_tag 'Merge impact cards' %>
            <div class="mt-2">
              <p class="text-sm/6 text-gray-600">Merge this impact card and all associated data with another card.</p>
              <div class="flex justify-end">
                <%=
                  link_to 'Merge Cards',
                  impact_card_path(@scorecard),
                  method: :delete,
                  data: { confirm: 'Are you sure you want to delete this impact card?' },
                  class: 'rounded-md bg-zinc-950 dark:bg-zinc-400 px-3 py-2 text-sm font-semibold text-white shadow-sm flex items-center space-x-2 text-red-600 hover:text-red-800'
                %>
              </div>
            </div>

          </div>
        <% end %>
      <% end %>

      <%= render 'form_buttons', form:, cancel_path: @scorecard.persisted? ? impact_card_path(@scorecard) : impact_cards_path %>
    <% end %>


  <% end %>
</div>
