<div class="max-w-4xl mx-auto">
  <div class="mb-8">
    <h1 class="text-2xl font-bold text-gray-900 mb-2">Import Comments for <%= @scorecard.name %></h1>
    <p class="text-gray-600">Upload a CSV file to import comments for checklist items in this Impact Card.</p>
  </div>

  <div class="grid md:grid-cols-2 gap-8">
    <!-- Import Form -->
    <div class="bg-white shadow rounded-lg p-6">
      <h2 class="text-lg font-semibold text-gray-900 mb-4">Upload CSV File</h2>
      
      <%= form_with url: import_comments_impact_card_path(@scorecard), method: :post, local: true, multipart: true, data: { turbo: false }, class: "space-y-4" do |form| %>
        <div>
          <%= form.label :csv_file, "Choose CSV file", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.file_field :csv_file, accept: ".csv", required: true, class: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" %>
        </div>
        
        <div class="flex justify-end">
          <%= form.submit "Import Comments", class: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium" %>
        </div>
      <% end %>
    </div>

    <!-- Instructions and Template -->
    <div class="space-y-6">
      <!-- Instructions -->
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <h3 class="text-sm font-semibold text-blue-900 mb-2">CSV Format Requirements</h3>
        <ul class="text-sm text-blue-800 space-y-1">
          <li>• First row must contain headers</li>
          <li>• Required columns: initiative_name, characteristic_name, status, comment</li>
          <li>• Initiative name must match existing initiative in this Impact Card</li>
          <li>• Characteristic name must match existing characteristic</li>
          <li>• Status must be one of: not_assessed, adequate, needs_attention, on_track, completed</li>
          <li>• Comment can be empty or contain text</li>
        </ul>
      </div>

      <!-- Download Template -->
      <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
        <h3 class="text-sm font-semibold text-gray-900 mb-2">Get the template</h3>
        <p class="text-sm text-gray-600 mb-3">Export the current comments from this Impact Card to get the correct CSV format.</p>
        <%= link_to "Export Current Comments", impact_card_path(@scorecard, format: :csv), 
            class: "inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",
            data: { turbo: false } %>
      </div>

      <!-- Warning -->
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
        <h3 class="text-sm font-semibold text-yellow-900 mb-2">⚠️ Important Notes</h3>
        <ul class="text-sm text-yellow-800 space-y-1">
          <li>• This will update existing checklist items in this Impact Card only</li>
          <li>• Changes will be tracked in the activity log</li>
          <li>• Invalid entries will be skipped with error messages</li>
          <li>• Only items that match existing initiatives and characteristics will be updated</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="mt-8 flex justify-start">
    <%= link_to "← Back to #{@scorecard.name}", impact_card_path(@scorecard), 
        class: "text-blue-600 hover:text-blue-700 text-sm font-medium" %>
  </div>
</div>
